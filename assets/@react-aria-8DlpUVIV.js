import{U as e,r as t}from"./react-DfeEZ_Rj.js";import{$ as n}from"./@react-stately-BA480pbT.js";const r="undefined"!=typeof document?e.useLayoutEffect:()=>{},o=e=>{var t;return null!==(t=null==e?void 0:e.ownerDocument)&&void 0!==t?t:document},i=e=>e&&"window"in e&&e.window===e?e:o(e).defaultView||window;function u(e){return null!==(t=e)&&"object"==typeof t&&"nodeType"in t&&"number"==typeof t.nodeType&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in e;var t}function s(e,t){if(!n())return!(!t||!e)&&e.contains(t);if(!e||!t)return!1;let r=t;for(;null!==r;){if(r===e)return!0;r="SLOT"===r.tagName&&r.assignedSlot?r.assignedSlot.parentNode:u(r)?r.host:r.parentNode}return!1}const a=(e=document)=>{var t;if(!n())return e.activeElement;let r=e.activeElement;for(;r&&"shadowRoot"in r&&(null===(t=r.shadowRoot)||void 0===t?void 0:t.activeElement);)r=r.shadowRoot.activeElement;return r};function c(e){return n()&&e.target.shadowRoot&&e.composedPath?e.composedPath()[0]:e.target}function l(e){let t=null;return()=>(null==t&&(t=e()),t)}const d=l((function(){return e=/^Mac/i,"undefined"!=typeof window&&null!=window.navigator&&e.test((null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.platform)||window.navigator.platform);var e,t})),v=l((function(){return e=/Android/i,"undefined"!=typeof window&&null!=window.navigator&&((null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.brands.some((t=>e.test(t.brand))))||e.test(window.navigator.userAgent));var e,t}));function f(){let e=t.useRef(new Map),n=t.useCallback(((t,n,r,o)=>{let i=(null==o?void 0:o.once)?(...t)=>{e.current.delete(r),r(...t)}:r;e.current.set(r,{type:n,eventTarget:t,fn:i,options:o}),t.addEventListener(n,i,o)}),[]),r=t.useCallback(((t,n,r,o)=>{var i;let u=(null===(i=e.current.get(r))||void 0===i?void 0:i.fn)||r;t.removeEventListener(n,u,o),e.current.delete(r)}),[]),o=t.useCallback((()=>{e.current.forEach(((e,t)=>{r(e.eventTarget,e.type,t,e.options)}))}),[r]);return t.useEffect((()=>o),[o]),{addGlobalListener:n,removeGlobalListener:r,removeAllGlobalListeners:o}}function p(e){let t=e;return t.nativeEvent=e,t.isDefaultPrevented=()=>t.defaultPrevented,t.isPropagationStopped=()=>t.cancelBubble,t.persist=()=>{},t}function g(e){let n=t.useRef({isFocused:!1,observer:null});r((()=>{const e=n.current;return()=>{e.observer&&(e.observer.disconnect(),e.observer=null)}}),[]);let o=function(e){const n=t.useRef(null);return r((()=>{n.current=e}),[e]),t.useCallback(((...e)=>{const t=n.current;return null==t?void 0:t(...e)}),[])}((t=>{null==e||e(t)}));return t.useCallback((e=>{if(e.target instanceof HTMLButtonElement||e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLSelectElement){n.current.isFocused=!0;let t=e.target,r=e=>{if(n.current.isFocused=!1,t.disabled){let t=p(e);o(t)}n.current.observer&&(n.current.observer.disconnect(),n.current.observer=null)};t.addEventListener("focusout",r,{once:!0}),n.current.observer=new MutationObserver((()=>{if(n.current.isFocused&&t.disabled){var e;null===(e=n.current.observer)||void 0===e||e.disconnect();let r=t===document.activeElement?null:document.activeElement;t.dispatchEvent(new FocusEvent("blur",{relatedTarget:r})),t.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:r}))}})),n.current.observer.observe(t,{attributes:!0,attributeFilter:["disabled"]})}}),[o])}let E=null,b=new Set,m=new Map,y=!1,T=!1;const w={Tab:!0,Escape:!0};function L(e,t){for(let n of b)n(e,t)}function h(e){var t;y=!0,!((t=e).metaKey||!d()&&t.altKey||t.ctrlKey||"Control"===t.key||"Shift"===t.key||"Meta"===t.key)&&(E="keyboard",L("keyboard",e))}function F(e){E="pointer","mousedown"!==e.type&&"pointerdown"!==e.type||(y=!0,L("pointer",e))}function k(e){var t;(0===(t=e).mozInputSource&&t.isTrusted||(v()&&t.pointerType?"click"===t.type&&1===t.buttons:0===t.detail&&!t.pointerType))&&(y=!0,E="virtual")}function H(e){e.target!==window&&e.target!==document&&e.isTrusted&&(y||T||(E="virtual",L("virtual",e)),y=!1,T=!1)}function M(){y=!1,T=!0}function P(e){if("undefined"==typeof window||m.get(i(e)))return;const t=i(e),n=o(e);let r=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){y=!0,r.apply(this,arguments)},n.addEventListener("keydown",h,!0),n.addEventListener("keyup",h,!0),n.addEventListener("click",k,!0),t.addEventListener("focus",H,!0),t.addEventListener("blur",M,!1),"undefined"!=typeof PointerEvent&&(n.addEventListener("pointerdown",F,!0),n.addEventListener("pointermove",F,!0),n.addEventListener("pointerup",F,!0)),t.addEventListener("beforeunload",(()=>{C(e)}),{once:!0}),m.set(t,{focus:r})}const C=(e,t)=>{const n=i(e),r=o(e);t&&r.removeEventListener("DOMContentLoaded",t),m.has(n)&&(n.HTMLElement.prototype.focus=m.get(n).focus,r.removeEventListener("keydown",h,!0),r.removeEventListener("keyup",h,!0),r.removeEventListener("click",k,!0),n.removeEventListener("focus",H,!0),n.removeEventListener("blur",M,!1),"undefined"!=typeof PointerEvent&&(r.removeEventListener("pointerdown",F,!0),r.removeEventListener("pointermove",F,!0),r.removeEventListener("pointerup",F,!0)),m.delete(n))};function S(){return"pointer"!==E}"undefined"!=typeof document&&function(e){const t=o(e);let n;"loading"!==t.readyState?P(e):(n=()=>{P(e)},t.addEventListener("DOMContentLoaded",n))}();const D=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let W=!1,A=0;function R(e){"touch"===e.pointerType&&(W=!0,setTimeout((()=>{W=!1}),50))}function x(){if("undefined"!=typeof document)return"undefined"!=typeof PointerEvent&&document.addEventListener("pointerup",R),A++,()=>{A--,A>0||"undefined"!=typeof PointerEvent&&document.removeEventListener("pointerup",R)}}function G(e){let{onHoverStart:n,onHoverChange:r,onHoverEnd:i,isDisabled:u}=e,[a,c]=t.useState(!1),l=t.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;t.useEffect(x,[]);let{addGlobalListener:d,removeAllGlobalListeners:v}=f(),{hoverProps:p,triggerHoverEnd:g}=t.useMemo((()=>{let e=(e,t)=>{let n=l.target;l.pointerType="",l.target=null,"touch"!==t&&l.isHovered&&n&&(l.isHovered=!1,v(),i&&i({type:"hoverend",target:n,pointerType:t}),r&&r(!1),c(!1))},t={};return"undefined"!=typeof PointerEvent&&(t.onPointerEnter=t=>{W&&"mouse"===t.pointerType||((t,i)=>{if(l.pointerType=i,u||"touch"===i||l.isHovered||!t.currentTarget.contains(t.target))return;l.isHovered=!0;let a=t.currentTarget;l.target=a,d(o(t.target),"pointerover",(t=>{l.isHovered&&l.target&&!s(l.target,t.target)&&e(0,t.pointerType)}),{capture:!0}),n&&n({type:"hoverstart",target:a,pointerType:i}),r&&r(!0),c(!0)})(t,t.pointerType)},t.onPointerLeave=t=>{!u&&t.currentTarget.contains(t.target)&&e(0,t.pointerType)}),{hoverProps:t,triggerHoverEnd:e}}),[n,r,i,u,l,d,v]);return t.useEffect((()=>{u&&g({currentTarget:l.target},l.pointerType)}),[u]),{hoverProps:p,isHovered:a}}function O(e={}){let{autoFocus:n=!1,isTextInput:r,within:u}=e,l=t.useRef({isFocused:!1,isFocusVisible:n||S()}),[d,v]=t.useState(!1),[E,m]=t.useState((()=>l.current.isFocused&&l.current.isFocusVisible)),y=t.useCallback((()=>m(l.current.isFocused&&l.current.isFocusVisible)),[]),T=t.useCallback((e=>{l.current.isFocused=e,v(e),y()}),[y]);var L,h,F;L=e=>{l.current.isFocusVisible=e,y()},h=[],F={isTextInput:r},P(),t.useEffect((()=>{let e=(e,t)=>{(function(e,t,n){let r=o(null==n?void 0:n.target);const u="undefined"!=typeof window?i(null==n?void 0:n.target).HTMLInputElement:HTMLInputElement,s="undefined"!=typeof window?i(null==n?void 0:n.target).HTMLTextAreaElement:HTMLTextAreaElement,a="undefined"!=typeof window?i(null==n?void 0:n.target).HTMLElement:HTMLElement,c="undefined"!=typeof window?i(null==n?void 0:n.target).KeyboardEvent:KeyboardEvent;return!((e=e||r.activeElement instanceof u&&!D.has(r.activeElement.type)||r.activeElement instanceof s||r.activeElement instanceof a&&r.activeElement.isContentEditable)&&"keyboard"===t&&n instanceof c&&!w[n.key])})(!!(null==F?void 0:F.isTextInput),e,t)&&L(S())};return b.add(e),()=>{b.delete(e)}}),h);let{focusProps:k}=function(e){let{isDisabled:n,onFocus:r,onBlur:i,onFocusChange:u}=e;const s=t.useCallback((e=>{if(e.target===e.currentTarget)return i&&i(e),u&&u(!1),!0}),[i,u]),l=g(s),d=t.useCallback((e=>{const t=o(e.target),n=t?a(t):a();e.target===e.currentTarget&&n===c(e.nativeEvent)&&(r&&r(e),u&&u(!0),l(e))}),[u,r,l]);return{focusProps:{onFocus:!n&&(r||u||i)?d:void 0,onBlur:n||!i&&!u?void 0:s}}}({isDisabled:u,onFocusChange:T}),{focusWithinProps:H}=function(e){let{isDisabled:n,onBlurWithin:r,onFocusWithin:i,onFocusWithinChange:u}=e,l=t.useRef({isFocusWithin:!1}),{addGlobalListener:d,removeAllGlobalListeners:v}=f(),E=t.useCallback((e=>{e.currentTarget.contains(e.target)&&l.current.isFocusWithin&&!e.currentTarget.contains(e.relatedTarget)&&(l.current.isFocusWithin=!1,v(),r&&r(e),u&&u(!1))}),[r,u,l,v]),b=g(E),m=t.useCallback((e=>{if(!e.currentTarget.contains(e.target))return;const t=o(e.target),n=a(t);if(!l.current.isFocusWithin&&n===c(e.nativeEvent)){i&&i(e),u&&u(!0),l.current.isFocusWithin=!0,b(e);let n=e.currentTarget;d(t,"focus",(e=>{if(l.current.isFocusWithin&&!s(n,e.target)){let i=new t.defaultView.FocusEvent("blur",{relatedTarget:e.target});r=i,o=n,Object.defineProperty(r,"target",{value:o}),Object.defineProperty(r,"currentTarget",{value:o});let u=p(i);E(u)}var r,o}),{capture:!0})}}),[i,u,b,d,E]);return n?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:m,onBlur:E}}}({isDisabled:!u,onFocusWithinChange:T});return{isFocused:d,isFocusVisible:E,focusProps:u?H:k}}export{O as $,G as a};
