import{R as e,r as t}from"./react-5K_EyRjd.js";import"./react-dom-t0gMm3eS.js";import{$ as n}from"./@react-stately-WraP1CKR.js";const r="undefined"!=typeof document?e.useLayoutEffect:()=>{};var o;const i=null!==(o=e.useInsertionEffect)&&void 0!==o?o:r,u=e=>{var t;return null!==(t=null==e?void 0:e.ownerDocument)&&void 0!==t?t:document},s=e=>e&&"window"in e&&e.window===e?e:u(e).defaultView||window;function a(e){return null!==(t=e)&&"object"==typeof t&&"nodeType"in t&&"number"==typeof t.nodeType&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"host"in e;var t}function c(e,t){if(!n())return!(!t||!e)&&e.contains(t);if(!e||!t)return!1;let r=t;for(;null!==r;){if(r===e)return!0;r="SLOT"===r.tagName&&r.assignedSlot?r.assignedSlot.parentNode:a(r)?r.host:r.parentNode}return!1}const l=(e=document)=>{var t;if(!n())return e.activeElement;let r=e.activeElement;for(;r&&"shadowRoot"in r&&(null===(t=r.shadowRoot)||void 0===t?void 0:t.activeElement);)r=r.shadowRoot.activeElement;return r};function d(e){return n()&&e.target.shadowRoot&&e.composedPath?e.composedPath()[0]:e.target}function v(e){let t=null;return()=>(null==t&&(t=e()),t)}const f=v(function(){return e=/^Mac/i,"undefined"!=typeof window&&null!=window.navigator&&e.test((null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.platform)||window.navigator.platform);var e,t}),p=v(function(){return function(e){var t;if("undefined"==typeof window||null==window.navigator)return!1;let n=null===(t=window.navigator.userAgentData)||void 0===t?void 0:t.brands;return Array.isArray(n)&&n.some(t=>e.test(t.brand))||e.test(window.navigator.userAgent)}(/Android/i)});function g(){let e=t.useRef(new Map),n=t.useCallback((t,n,r,o)=>{let i=(null==o?void 0:o.once)?(...t)=>{e.current.delete(r),r(...t)}:r;e.current.set(r,{type:n,eventTarget:t,fn:i,options:o}),t.addEventListener(n,i,o)},[]),r=t.useCallback((t,n,r,o)=>{var i;let u=(null===(i=e.current.get(r))||void 0===i?void 0:i.fn)||r;t.removeEventListener(n,u,o),e.current.delete(r)},[]),o=t.useCallback(()=>{e.current.forEach((e,t)=>{r(e.eventTarget,e.type,t,e.options)})},[r]);return t.useEffect(()=>o,[o]),{addGlobalListener:n,removeGlobalListener:r,removeAllGlobalListeners:o}}function E(e){let t=e;return t.nativeEvent=e,t.isDefaultPrevented=()=>t.defaultPrevented,t.isPropagationStopped=()=>t.cancelBubble,t.persist=()=>{},t}function m(e){let n=t.useRef({isFocused:!1,observer:null});r(()=>{const e=n.current;return()=>{e.observer&&(e.observer.disconnect(),e.observer=null)}},[]);let o=function(e){const n=t.useRef(null);return i(()=>{n.current=e},[e]),t.useCallback((...e)=>{const t=n.current;return null==t?void 0:t(...e)},[])}(t=>{null==e||e(t)});return t.useCallback(e=>{if(e.target instanceof HTMLButtonElement||e.target instanceof HTMLInputElement||e.target instanceof HTMLTextAreaElement||e.target instanceof HTMLSelectElement){n.current.isFocused=!0;let t=e.target,r=e=>{if(n.current.isFocused=!1,t.disabled){let t=E(e);o(t)}n.current.observer&&(n.current.observer.disconnect(),n.current.observer=null)};t.addEventListener("focusout",r,{once:!0}),n.current.observer=new MutationObserver(()=>{if(n.current.isFocused&&t.disabled){var e;null===(e=n.current.observer)||void 0===e||e.disconnect();let r=t===document.activeElement?null:document.activeElement;t.dispatchEvent(new FocusEvent("blur",{relatedTarget:r})),t.dispatchEvent(new FocusEvent("focusout",{bubbles:!0,relatedTarget:r}))}}),n.current.observer.observe(t,{attributes:!0,attributeFilter:["disabled"]})}},[o])}let b=null,y=new Set,T=new Map,w=!1,L=!1;const h={Tab:!0,Escape:!0};function F(e,t){for(let n of y)n(e,t)}function k(e){var t;w=!0,!((t=e).metaKey||!f()&&t.altKey||t.ctrlKey||"Control"===t.key||"Shift"===t.key||"Meta"===t.key)&&(b="keyboard",F("keyboard",e))}function H(e){b="pointer","mousedown"!==e.type&&"pointerdown"!==e.type||(w=!0,F("pointer",e))}function M(e){var t;(0===(t=e).mozInputSource&&t.isTrusted||(p()&&t.pointerType?"click"===t.type&&1===t.buttons:0===t.detail&&!t.pointerType))&&(w=!0,b="virtual")}function P(e){e.target!==window&&e.target!==document&&e.isTrusted&&(w||L||(b="virtual",F("virtual",e)),w=!1,L=!1)}function C(){w=!1,L=!0}function S(e){if("undefined"==typeof window||"undefined"==typeof document||T.get(s(e)))return;const t=s(e),n=u(e);let r=t.HTMLElement.prototype.focus;t.HTMLElement.prototype.focus=function(){w=!0,r.apply(this,arguments)},n.addEventListener("keydown",k,!0),n.addEventListener("keyup",k,!0),n.addEventListener("click",M,!0),t.addEventListener("focus",P,!0),t.addEventListener("blur",C,!1),"undefined"!=typeof PointerEvent&&(n.addEventListener("pointerdown",H,!0),n.addEventListener("pointermove",H,!0),n.addEventListener("pointerup",H,!0)),t.addEventListener("beforeunload",()=>{A(e)},{once:!0}),T.set(t,{focus:r})}const A=(e,t)=>{const n=s(e),r=u(e);t&&r.removeEventListener("DOMContentLoaded",t),T.has(n)&&(n.HTMLElement.prototype.focus=T.get(n).focus,r.removeEventListener("keydown",k,!0),r.removeEventListener("keyup",k,!0),r.removeEventListener("click",M,!0),n.removeEventListener("focus",P,!0),n.removeEventListener("blur",C,!1),"undefined"!=typeof PointerEvent&&(r.removeEventListener("pointerdown",H,!0),r.removeEventListener("pointermove",H,!0),r.removeEventListener("pointerup",H,!0)),T.delete(n))};function D(){return"pointer"!==b}"undefined"!=typeof document&&function(e){const t=u(e);let n;"loading"!==t.readyState?S(e):(n=()=>{S(e)},t.addEventListener("DOMContentLoaded",n))}();const W=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let R=!1,x=0;function G(e){"touch"===e.pointerType&&(R=!0,setTimeout(()=>{R=!1},50))}function I(){if("undefined"!=typeof document)return 0===x&&"undefined"!=typeof PointerEvent&&document.addEventListener("pointerup",G),x++,()=>{x--,x>0||"undefined"!=typeof PointerEvent&&document.removeEventListener("pointerup",G)}}function O(e){let{onHoverStart:n,onHoverChange:r,onHoverEnd:o,isDisabled:i}=e,[s,a]=t.useState(!1),l=t.useRef({isHovered:!1,ignoreEmulatedMouseEvents:!1,pointerType:"",target:null}).current;t.useEffect(I,[]);let{addGlobalListener:d,removeAllGlobalListeners:v}=g(),{hoverProps:f,triggerHoverEnd:p}=t.useMemo(()=>{let e=(e,t)=>{let n=l.target;l.pointerType="",l.target=null,"touch"!==t&&l.isHovered&&n&&(l.isHovered=!1,v(),o&&o({type:"hoverend",target:n,pointerType:t}),r&&r(!1),a(!1))},t={};return"undefined"!=typeof PointerEvent&&(t.onPointerEnter=t=>{R&&"mouse"===t.pointerType||((t,o)=>{if(l.pointerType=o,i||"touch"===o||l.isHovered||!t.currentTarget.contains(t.target))return;l.isHovered=!0;let s=t.currentTarget;l.target=s,d(u(t.target),"pointerover",t=>{l.isHovered&&l.target&&!c(l.target,t.target)&&e(0,t.pointerType)},{capture:!0}),n&&n({type:"hoverstart",target:s,pointerType:o}),r&&r(!0),a(!0)})(t,t.pointerType)},t.onPointerLeave=t=>{!i&&t.currentTarget.contains(t.target)&&e(0,t.pointerType)}),{hoverProps:t,triggerHoverEnd:e}},[n,r,o,i,l,d,v]);return t.useEffect(()=>{i&&p({currentTarget:l.target},l.pointerType)},[i]),{hoverProps:f,isHovered:s}}function B(e={}){let{autoFocus:n=!1,isTextInput:r,within:o}=e,i=t.useRef({isFocused:!1,isFocusVisible:n||D()}),[a,v]=t.useState(!1),[f,p]=t.useState(()=>i.current.isFocused&&i.current.isFocusVisible),b=t.useCallback(()=>p(i.current.isFocused&&i.current.isFocusVisible),[]),T=t.useCallback(e=>{i.current.isFocused=e,v(e),b()},[b]);var w,L,F;w=e=>{i.current.isFocusVisible=e,b()},L=[],F={isTextInput:r},S(),t.useEffect(()=>{let e=(e,t)=>{(function(e,t,n){let r=u(null==n?void 0:n.target);const o="undefined"!=typeof window?s(null==n?void 0:n.target).HTMLInputElement:HTMLInputElement,i="undefined"!=typeof window?s(null==n?void 0:n.target).HTMLTextAreaElement:HTMLTextAreaElement,a="undefined"!=typeof window?s(null==n?void 0:n.target).HTMLElement:HTMLElement,c="undefined"!=typeof window?s(null==n?void 0:n.target).KeyboardEvent:KeyboardEvent;return!((e=e||r.activeElement instanceof o&&!W.has(r.activeElement.type)||r.activeElement instanceof i||r.activeElement instanceof a&&r.activeElement.isContentEditable)&&"keyboard"===t&&n instanceof c&&!h[n.key])})(!!(null==F?void 0:F.isTextInput),e,t)&&w(D())};return y.add(e),()=>{y.delete(e)}},L);let{focusProps:k}=function(e){let{isDisabled:n,onFocus:r,onBlur:o,onFocusChange:i}=e;const s=t.useCallback(e=>{if(e.target===e.currentTarget)return o&&o(e),i&&i(!1),!0},[o,i]),a=m(s),c=t.useCallback(e=>{const t=u(e.target),n=t?l(t):l();e.target===e.currentTarget&&n===d(e.nativeEvent)&&(r&&r(e),i&&i(!0),a(e))},[i,r,a]);return{focusProps:{onFocus:!n&&(r||i||o)?c:void 0,onBlur:n||!o&&!i?void 0:s}}}({isDisabled:o,onFocusChange:T}),{focusWithinProps:H}=function(e){let{isDisabled:n,onBlurWithin:r,onFocusWithin:o,onFocusWithinChange:i}=e,s=t.useRef({isFocusWithin:!1}),{addGlobalListener:a,removeAllGlobalListeners:v}=g(),f=t.useCallback(e=>{e.currentTarget.contains(e.target)&&s.current.isFocusWithin&&!e.currentTarget.contains(e.relatedTarget)&&(s.current.isFocusWithin=!1,v(),r&&r(e),i&&i(!1))},[r,i,s,v]),p=m(f),b=t.useCallback(e=>{if(!e.currentTarget.contains(e.target))return;const t=u(e.target),n=l(t);if(!s.current.isFocusWithin&&n===d(e.nativeEvent)){o&&o(e),i&&i(!0),s.current.isFocusWithin=!0,p(e);let n=e.currentTarget;a(t,"focus",e=>{if(s.current.isFocusWithin&&!c(n,e.target)){let i=new t.defaultView.FocusEvent("blur",{relatedTarget:e.target});r=i,o=n,Object.defineProperty(r,"target",{value:o}),Object.defineProperty(r,"currentTarget",{value:o});let u=E(i);f(u)}var r,o},{capture:!0})}},[o,i,p,a,f]);return n?{focusWithinProps:{onFocus:void 0,onBlur:void 0}}:{focusWithinProps:{onFocus:b,onBlur:f}}}({isDisabled:!o,onFocusWithinChange:T});return{isFocused:a,isFocusVisible:f,focusProps:o?H:k}}export{B as $,O as a};
