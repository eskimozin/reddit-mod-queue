import{r as e,j as t}from"./react-DfeEZ_Rj.js";import{P as r}from"./prop-types-6BVzj02S.js";import{h as s}from"./moment-Dbf0ZKEX.js";import{A as o}from"./index-ChxXGzYs.js";import{L as n}from"./react-router-BqItNVJU.js";import{H as i}from"./@headlessui-SdtWb-yt.js";import{a}from"./axios-ClDWm0N0.js";import"./cookie-DpVX6GIM.js";import"./react-dom-BuftSLf4.js";import"./scheduler-CebB03oh.js";import"./framer-motion-Doa5B51o.js";import"./motion-dom-DDsKZDIB.js";import"./motion-utils-CzqutjiG.js";import"./@react-aria-8DlpUVIV.js";import"./@react-stately-BA480pbT.js";const l=e.createContext(null);function c({children:r}){const[s,o]=e.useState(""),[n,i]=e.useState(""),[a,c]=e.useState(null),[d,m]=e.useState(!0),[u,p]=e.useState(null),h={vUpdateTime:s,setVUpdateTime:o,latestRegister:n,setLatestRegister:i,postsPending:a,setPostsPending:c,isLoading:d,setIsLoading:m,error:u,setError:p};return t.jsx(l.Provider,{value:{...h},children:r})}function d({children:e}){return t.jsx("span",{className:"arial",children:e})}function m({time:r}){function o(e){const t=new Date(e),r=new Intl.DateTimeFormat("en-CA",{timeZone:"America/Sao_Paulo",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).formatToParts(t),s=e=>{var t;return null==(t=r.find((t=>t.type===e)))?void 0:t.value};return`${s("year")}-${s("month")}-${s("day")}T${s("hour")}:${s("minute")}:${s("second")}`}const n=s(o(new Date(r))),[i,a]=e.useState("pouco"),l=e.useCallback((()=>{const e=s(o(new Date)),t=e.diff(n,"seconds");let r=e.diff(n,"minutes"),i=e.diff(n,"hours");i="localhost"===window.location.hostname?i:i-3,r="localhost"!==window.location.hostname&&r>=180?r-180:r,i="localhost"!==window.location.hostname&&r>=60&&i<4?Math.floor(r/60):i,a(i>0?`${i} ${i>1?"horas":"hora"}`:r>0?`${r} ${r>1?"minutos":"minuto"}`:t>0?`${t} ${t>1?"segundos":"segundo"}`:"pouco")}),[n]);return e.useEffect((()=>{l();const e=setInterval(l,1e3);return()=>clearInterval(e)}),[l]),t.jsx(t.Fragment,{children:i})}function u({children:e}){return t.jsx("div",{className:"group grid max-w-sm h-[100%] gap-6 md:mx-auto lg:mx-auto lg:max-w-none lg:grid-cols-4",children:e})}function p({children:r,className:s=""}){const o=e.useRef(null),n=function(){const[t,r]=e.useState({x:0,y:0});return e.useEffect((()=>{const e=e=>{r({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]),t}(),i=e.useRef({x:0,y:0}),a=e.useRef({w:0,h:0}),[l,c]=e.useState([]);e.useEffect((()=>{o.current&&c(Array.from(o.current.children).map((e=>e)))}),[]),e.useEffect((()=>(d(),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)})),[l]),e.useEffect((()=>{m()}),[n]);const d=()=>{o.current&&(a.current.w=o.current.offsetWidth,a.current.h=o.current.offsetHeight)},m=()=>{if(o.current){const e=o.current.getBoundingClientRect(),{w:t,h:r}=a.current,s=n.x-e.left,c=n.y-e.top;s<t&&s>0&&c<r&&c>0&&(i.current.x=s,i.current.y=c,l.forEach((t=>{const r=-(t.getBoundingClientRect().left-e.left)+i.current.x,s=-(t.getBoundingClientRect().top-e.top)+i.current.y;t.style.setProperty("--mouse-x",`${r}px`),t.style.setProperty("--mouse-y",`${s}px`)})))}};return t.jsx("div",{className:s,ref:o,children:r})}c.propTypes={children:r.node},d.propTypes={children:r.node},m.propTypes={time:r.string.isRequired},u.propTypes={children:r.node};const h="eskimozin",f="localhost"===window.location.hostname?"http://localhost:8001":"https://gabriers.up.railway.app",x="https://github.com/eskimozin/reddit-mod-queue/issues/new",g="https://reddit.com/r/eskimozin",j={rel:"noopener noreferrer",target:"_blank",className:"focus-headless focus:text-white hover:text-white transition-colors"};function b({title:e,img:r,subtitle:s,description:o,action:a=()=>{},btnLabel:l="Abrir no Reddit",link:c=g}){let d=t.jsx(p,{children:t.jsxs("div",{className:"relative overflow-hidden before:pointer-events-none before:absolute before:-left-40 before:-top-40 before:z-10 before:h-80 before:w-80 before:translate-x-[var(--mouse-x)] before:translate-y-[var(--mouse-y)] before:rounded-full before:border-slate-500 before:opacity-0 before:blur-3xl before:transition-opacity before:duration-500 after:pointer-events-none after:absolute after:-left-48 after:-top-48 after:z-30 after:h-64 after:w-64 after:translate-x-[var(--mouse-x)] after:translate-y-[var(--mouse-y)] after:rounded-full after:bg-slate-600 after:opacity-0 after:blur-3xl after:transition-opacity after:duration-500 after:hover:opacity-20 before:group-hover:opacity-100 bg-blackrounded-md text-white border border-white/10 bg-white/5 rounded-lg",children:[r?t.jsx("div",{className:"relative z-15",children:t.jsx("img",{src:r,className:"object-cover w-full h-[200px]",alt:e})}):"",t.jsxs("div",{className:"relative z-20 p-4 pt-5",children:[t.jsx("h2",{className:"block font-semibold text-xl line-clamp-2 text-ellipsis",children:e||"Título não retornado"}),t.jsx("p",{className:"text-gray-400 font-semibold mt-1 mb-0 line-clamp-2 text-ellipsis",children:s||"Usuário do post não retornado"}),t.jsx("p",{className:"mt-3 mb-4 pb-1",children:o}),t.jsxs(i,{className:"inline-flex items-center gap-1 rounded-[5px] bg-orange-600 border-orange-700 focus:bg-orange-700 hover:bg-orange-700 px-3 py-2 text-white/95  focus:not-data-focus:outline-none data-focus:outline data-focus:outline-white data-hover:bg-gray-600 data-open:bg-gray-700 focus-headless mb-1 transition-colors",onClick:e=>{e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),a&&a()},children:[l,t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"16px",viewBox:"0 -960 960 960",width:"16px",fill:"#FFF",children:t.jsx("path",{d:"M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h560v-280h80v280q0 33-23.5 56.5T760-120H200Zm188-212-56-56 372-372H560v-80h280v280h-80v-144L388-332Z"})})]})]})]})});return c?t.jsx(n,{to:c,...j,children:t.jsx(t.Fragment,{children:d})}):d}function v({children:e}){return t.jsx("div",{className:"bg-slate-800 border border-white/10 rounded-md p-3 mt-5 text-slate-400 items-center gap-2 inline-flex",children:e})}b.propTypes={title:r.string,subtitle:r.string,img:r.string,description:r.string,action:r.func,btnLabel:r.string},v.propTypes={children:r.node};const w=()=>{const{vUpdateTime:r,latestRegister:s}=e.useContext(l);return t.jsxs("hgroup",{className:"flex items-center gap-4 mb-8 flex-wrap",children:[t.jsx("img",{src:"https://styles.redditmedia.com/t5_djonfq/styles/communityIcon_so6opouwbkwe1.jpeg?format=pjpg&s=87d36ec6c490962999a51fdc8b64bf180892131a",alt:"Foto de perfil do r/eskimozin",className:"rounded-full w-[50px] h-[50px] object-cover"}),t.jsxs("div",{className:"block",children:[t.jsxs("h1",{className:"text-balance font-bold text-3xl",children:["Fila de moderação do ",t.jsxs("span",{className:"text-orange-600",children:["r",t.jsx(d,{children:"/"}),h]})]}),t.jsxs("p",{className:"mb-0 mt-1 text-gray-400 text-balance max-w-[600px]",children:["Atualizado há ",r?t.jsx(m,{time:r}):"pouco",". O último post entrou na fila de moderação há ",s?t.jsx(m,{time:s}):"pouco",". A verificação da fila de moderação é feita a cada 5 minutos."]})]})]})},y=()=>{const{isLoading:r,postsPending:s,error:n}=e.useContext(l);return t.jsx(u,{children:t.jsx(o,{children:r&&!s?t.jsx(b,{title:"Carregando...",subtitle:"Conectando à API, aguarde",description:"Geralmente isso é rápido mas pode ser que demore um pouco.",link:g,btnLabel:"Ir pro subreddit"}):s?s.map(((t,r)=>{const s={title:t.post_title,subtitle:t.post_author_name,description:"",img:t.post_img_url,link:t.reddit_link,action:()=>{window.open(t.reddit_link,"_blank","noreferrer noopener")}};return e.createElement(b,{...s,key:r})})):n?t.jsx(b,{title:"Ocorreu um erro: "+n,subtitle:"Algo não saiu como deveria...",description:"",link:x,btnLabel:"Reportar"}):t.jsx(b,{title:"Não há nada por aqui...",subtitle:"Tudo certo!",description:"Sem posts para a moderação avaliar. Pegue uma bebida e aguarde.",btnLabel:"Ir pro subreddit"})})})},N=()=>{const{postsPending:r}=e.useContext(l);return t.jsxs(t.Fragment,{children:[r&&r.length>=10&&t.jsx(o,{children:t.jsxs(v,{children:[t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"#94A3B8",className:"bi bi-exclamation-circle",viewBox:"0 0 16 16",children:[t.jsx("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"}),t.jsx("path",{d:"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"})]}),t.jsx("span",{children:"Listamos apenas os 10 últimos posts pendentes de moderação."})]})}),t.jsx(v,{children:t.jsxs("div",{className:"flex gap-1 items-center",children:[t.jsx("p",{children:"Encontrou um erro?"})," ",t.jsx("a",{href:x,...j,children:t.jsxs("div",{className:"flex gap-1 items-center",children:[t.jsx("span",{className:"text-white",children:"Avisa pra gente!"}),t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"16px",viewBox:"0 -960 960 960",width:"16px",fill:"#FFF",children:t.jsx("path",{d:"M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h280v80H200v560h560v-280h80v280q0 33-23.5 56.5T760-120H200Zm188-212-56-56 372-372H560v-80h280v280h-80v-144L388-332Z"})})]})})]})})]})};function T(){const{setVUpdateTime:t,setLatestRegister:r,setPostsPending:o,setIsLoading:n,setError:i}=e.useContext(l);return e.useEffect((()=>{try{a.post(`${f}/api/get-latest-register/`).then((e=>{const{data:o}=e;if(o&&o.rows[0][0].datetime_register){const e=o.rows[0][0].datetime_register;r(e)}t(s().format("YYYY-MM-DDTHH:mm:ssZ"))}))}catch(e){alert("Um erro ocorreu! "+e.message)}}),[r,t]),e.useEffect((()=>{try{a.post(`${f}/api/get-unmoderates-posts/`).then((e=>{const{data:r}=e;r&&r.rows[0].length>0&&o(r.rows[0]),t(s().format("YYYY-MM-DDTHH:mm:ssZ"))})).catch((e=>{i(e.message)})).finally((()=>{n(!1)}))}catch(e){}}),[i,n,o,t]),null}function k(){const e={fontWeight:300,fontFamily:'"Inter Tight", "Inter", sans-serif',letterSpacing:.2};return t.jsx("div",{className:"container text-center pt-8 lg:pt-10 mt-8 lg:mt-10 border-t border-slate-800",children:t.jsxs("p",{className:"text-gray-400",children:[t.jsxs("div",{className:"flex items-center justify-center gap-1 text-decoration-none fw-light",style:{...e,color:"inherit"},children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",className:"bi bi-c-circle",viewBox:"0 0 16 16",children:t.jsx("path",{d:"M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.146 4.992c-1.212 0-1.927.92-1.927 2.502v1.06c0 1.571.703 2.462 1.927 2.462.979 0 1.641-.586 1.729-1.418h1.295v.093c-.1 1.448-1.354 2.467-3.03 2.467-2.091 0-3.269-1.336-3.269-3.603V7.482c0-2.261 1.201-3.638 3.27-3.638 1.681 0 2.935 1.054 3.029 2.572v.088H9.875c-.088-.879-.768-1.512-1.729-1.512"})}),t.jsxs("span",{children:[s().utc().format("YYYY")," - "]}),t.jsxs("span",{children:["Fila de moderação do r",t.jsx(d,{children:"/"}),h]})]}),t.jsxs("a",{href:"https://github.com/gabriersdev",className:"text-decoration-none fw-light focus-headless",style:{...e,color:"inherit"},children:["Feito com 💖 pelo ","Gabriel","."]})]})})}function L(){return t.jsxs(c,{children:[t.jsx(T,{}),t.jsx("div",{className:"flex align-center justify-center",children:t.jsxs("div",{className:"container mx-3 my-8 lg:my-10 min-h-[90vh] flex justify-between flex-col",children:[t.jsxs("main",{children:[t.jsxs(o,{children:[t.jsx(w,{}),t.jsx(y,{})]}),t.jsx(N,{})]}),t.jsx(k,{})]})})]})}export{L as default};
